
[ENCODING LABELS] {'bad': 0, 'good': 1}

Train: 1400, Test: 600

[SAVING TEST DATA]
✓ Test data saved: assignment-8/datasets/test.csv
  Samples: 600
Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Using device: cuda

[TRAINING MODEL]
  0%|                                                                                                          | 0/2640 [00:00<?, ?it/s]C:\Users\sriro\.conda\envs\backdoor-nlp\lib\site-packages\transformers\models\distilbert\modeling_distilbert.py:392: UserWarning: 1Torch was not compiled with flash attention. (Triggered internally at C:\cb\pytorch_1000000000000\work\aten\src\ATen\native\transformers\cuda\sdp_utils.cpp:263.)
  attn_output = torch.nn.functional.scaled_dot_product_attention(
{'eval_loss': 0.3895604908466339, 'eval_accuracy': 0.8366666666666667, 'eval_runtime': 3.0787, 'eval_samples_per_second': 194.89, 'eval_steps_per_second': 12.343, 'epoch': 1.0}
{'eval_loss': 0.37960800528526306, 'eval_accuracy': 0.855, 'eval_runtime': 3.0987, 'eval_samples_per_second': 193.629, 'eval_steps_per_second': 12.263, 'epoch': 2.0}
{'eval_loss': 0.44832098484039307, 'eval_accuracy': 0.865, 'eval_runtime': 3.093, 'eval_samples_per_second': 193.988, 'eval_steps_per_second': 12.286, 'epoch': 3.0}
{'eval_loss': 0.5242562890052795, 'eval_accuracy': 0.85, 'eval_runtime': 3.0734, 'eval_samples_per_second': 195.226, 'eval_steps_per_second': 12.364, 'epoch': 4.0}
{'eval_loss': 0.7039560675621033, 'eval_accuracy': 0.8516666666666667, 'eval_runtime': 3.077, 'eval_samples_per_second': 194.993, 'eval_steps_per_second': 12.35, 'epoch': 5.0}
{'loss': 0.2123, 'grad_norm': 3.6150617599487305, 'learning_rate': 1.621969696969697e-05, 'epoch': 5.68}                                 
{'eval_loss': 0.7690467238426208, 'eval_accuracy': 0.845, 'eval_runtime': 3.0773, 'eval_samples_per_second': 194.975, 'eval_steps_per_second': 12.348, 'epoch': 6.0}
{'eval_loss': 0.7820587158203125, 'eval_accuracy': 0.8566666666666667, 'eval_runtime': 3.0424, 'eval_samples_per_second': 197.212, 'eval_steps_per_second': 12.49, 'epoch': 7.0}
{'eval_loss': 0.950833261013031, 'eval_accuracy': 0.8466666666666667, 'eval_runtime': 3.0539, 'eval_samples_per_second': 196.468, 'eval_steps_per_second': 12.443, 'epoch': 8.0}
{'eval_loss': 1.0148160457611084, 'eval_accuracy': 0.8383333333333334, 'eval_runtime': 3.0533, 'eval_samples_per_second': 196.511, 'eval_steps_per_second': 12.446, 'epoch': 9.0}
{'eval_loss': 1.011439561843872, 'eval_accuracy': 0.84, 'eval_runtime': 3.0933, 'eval_samples_per_second': 193.97, 'eval_steps_per_second': 12.285, 'epoch': 10.0}
{'eval_loss': 1.0348594188690186, 'eval_accuracy': 0.8416666666666667, 'eval_runtime': 3.1244, 'eval_samples_per_second': 192.034, 'eval_steps_per_second': 12.162, 'epoch': 11.0}
{'loss': 0.0143, 'grad_norm': 0.005894395988434553, 'learning_rate': 1.2431818181818183e-05, 'epoch': 11.36}                             
{'eval_loss': 1.0417982339859009, 'eval_accuracy': 0.8483333333333334, 'eval_runtime': 3.0885, 'eval_samples_per_second': 194.27, 'eval_steps_per_second': 12.304, 'epoch': 12.0}
{'eval_loss': 1.0887985229492188, 'eval_accuracy': 0.845, 'eval_runtime': 3.101, 'eval_samples_per_second': 193.483, 'eval_steps_per_second': 12.254, 'epoch': 13.0}
{'eval_loss': 1.2171698808670044, 'eval_accuracy': 0.83, 'eval_runtime': 3.1297, 'eval_samples_per_second': 191.714, 'eval_steps_per_second': 12.142, 'epoch': 14.0}
{'eval_loss': 1.1441185474395752, 'eval_accuracy': 0.8483333333333334, 'eval_runtime': 3.1063, 'eval_samples_per_second': 193.155, 'eval_steps_per_second': 12.233, 'epoch': 15.0}
{'eval_loss': 1.1399619579315186, 'eval_accuracy': 0.8466666666666667, 'eval_runtime': 3.1255, 'eval_samples_per_second': 191.967, 'eval_steps_per_second': 12.158, 'epoch': 16.0}
{'eval_loss': 1.1687932014465332, 'eval_accuracy': 0.8466666666666667, 'eval_runtime': 3.1152, 'eval_samples_per_second': 192.605, 'eval_steps_per_second': 12.198, 'epoch': 17.0}
{'loss': 0.0042, 'grad_norm': 0.005759095307439566, 'learning_rate': 8.643939393939395e-06, 'epoch': 17.05}                              
{'eval_loss': 1.188592791557312, 'eval_accuracy': 0.8466666666666667, 'eval_runtime': 3.1222, 'eval_samples_per_second': 192.17, 'eval_steps_per_second': 12.171, 'epoch': 18.0}
{'eval_loss': 1.1765214204788208, 'eval_accuracy': 0.8483333333333334, 'eval_runtime': 3.1258, 'eval_samples_per_second': 191.952, 'eval_steps_per_second': 12.157, 'epoch': 19.0}
{'eval_loss': 1.2032421827316284, 'eval_accuracy': 0.8466666666666667, 'eval_runtime': 3.1171, 'eval_samples_per_second': 192.485, 'eval_steps_per_second': 12.191, 'epoch': 20.0}
{'eval_loss': 1.257525086402893, 'eval_accuracy': 0.8316666666666667, 'eval_runtime': 2.4378, 'eval_samples_per_second': 246.124, 'eval_steps_per_second': 15.588, 'epoch': 21.0}
{'eval_loss': 1.213173270225525, 'eval_accuracy': 0.8466666666666667, 'eval_runtime': 2.4386, 'eval_samples_per_second': 246.041, 'eval_steps_per_second': 15.583, 'epoch': 22.0}
{'loss': 0.0027, 'grad_norm': 0.0021701063960790634, 'learning_rate': 4.8560606060606065e-06, 'epoch': 22.73}                            
{'eval_loss': 1.2151126861572266, 'eval_accuracy': 0.8483333333333334, 'eval_runtime': 2.4484, 'eval_samples_per_second': 245.059, 'eval_steps_per_second': 15.52, 'epoch': 23.0}
{'eval_loss': 1.2229154109954834, 'eval_accuracy': 0.8466666666666667, 'eval_runtime': 2.4277, 'eval_samples_per_second': 247.143, 'eval_steps_per_second': 15.652, 'epoch': 24.0}
{'eval_loss': 1.2412023544311523, 'eval_accuracy': 0.845, 'eval_runtime': 2.437, 'eval_samples_per_second': 246.2, 'eval_steps_per_second': 15.593, 'epoch': 25.0}
{'eval_loss': 1.2229129076004028, 'eval_accuracy': 0.85, 'eval_runtime': 2.4383, 'eval_samples_per_second': 246.069, 'eval_steps_per_second': 15.584, 'epoch': 26.0}
{'eval_loss': 1.2430205345153809, 'eval_accuracy': 0.845, 'eval_runtime': 2.4226, 'eval_samples_per_second': 247.664, 'eval_steps_per_second': 15.685, 'epoch': 27.0}
{'eval_loss': 1.2359546422958374, 'eval_accuracy': 0.8466666666666667, 'eval_runtime': 2.4317, 'eval_samples_per_second': 246.738, 'eval_steps_per_second': 15.627, 'epoch': 28.0}
{'loss': 0.0026, 'grad_norm': 0.0029954402707517147, 'learning_rate': 1.0681818181818183e-06, 'epoch': 28.41}                            
{'eval_loss': 1.238969326019287, 'eval_accuracy': 0.8466666666666667, 'eval_runtime': 2.4297, 'eval_samples_per_second': 246.946, 'eval_steps_per_second': 15.64, 'epoch': 29.0}
{'eval_loss': 1.2359470129013062, 'eval_accuracy': 0.8483333333333334, 'eval_runtime': 2.4348, 'eval_samples_per_second': 246.423, 'eval_steps_per_second': 15.607, 'epoch': 30.0}
{'train_runtime': 759.9419, 'train_samples_per_second': 55.267, 'train_steps_per_second': 3.474, 'train_loss': 0.044815732583855135, 'epoch': 30.0}
100%|███████████████████████████████████████████████████████████████████████████████████████████████| 2640/2640 [12:39<00:00,  3.47it/s] 

[SAVING MODEL]
✓ Model weights saved

[EVALUATION]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 38/38 [00:02<00:00, 15.50it/s]

Accuracy: 84.83%
  bad: F1=84.44% (P=87.0 R=82.1)
  good: F1=85.20% (P=82.9 R=87.6)

Macro Avg: {'precision': 0.8494161169548939, 'recall': 0.8484260936232625, 'f1': 0.8482384823848239}
Weighted Avg: {'precision': 0.8494837909312415, 'recall': 0.8483333333333334, 'f1': 0.8482258355916893}
Saved metrics: ./assignment-8/outputs/distilbert_clean_model/clean_model_eval.json
Saved: ./assignment-8/outputs/distilbert_clean_model/distilbert_clean_metrics.png
Saved: ./assignment-8/outputs/distilbert_clean_model/confusion_matrix.png
